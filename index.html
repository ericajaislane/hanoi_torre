<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Torre de Hanoi</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    margin: 20px;
  }
  #torres {
    display: flex;
    justify-content: center;
    margin-top: 40px;
  }
  .torre {
    width: 120px;
    height: 300px;
    border: 2px solid #333;
    margin: 0 20px;
    position: relative;
    background: #f4f4f4;
    border-radius: 6px;
    display: flex;
    flex-direction: column-reverse;
    align-items: center;
    padding-bottom: 30px;
  }
  .disco {
    height: 20px;
    margin: 4px 0;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    user-select: none;
  }
  .disco[data-tamanho="1"] { width: 40px; background: #f44336; }
  .disco[data-tamanho="2"] { width: 60px; background: #ff9800; }
  .disco[data-tamanho="3"] { width: 80px; background: #ffeb3b; }
  .disco[data-tamanho="4"] { width: 100px; background: #2196f3; }
  .disco[data-tamanho="5"] { width: 120px; background: #9c27b0; }

  .disco.selecionado {
    border: 3px solid red;
    filter: brightness(1.2);
  }

  .torre-label {
    position: absolute;
    bottom: -25px;
    width: 100%;
    font-weight: bold;
    font-size: 18px;
  }

  #mensagem {
    margin-top: 20px;
    font-size: 1.2em;
    min-height: 1.5em;
  }

  #controles {
    margin-bottom: 15px;
  }

  button {
    margin-left: 8px;
    padding: 6px 12px;
    font-size: 14px;
    cursor: pointer;
  }

  #movimentos {
    margin-top: 15px;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>Torre de Hanoi</h1>

<div id="controles">
  <label for="numDiscos">N√∫mero de discos (3 a 5): </label>
  <input type="number" id="numDiscos" value="3" min="3" max="5" />
  <button onclick="iniciarJogo()">Iniciar Jogo</button>
  <button onclick="reiniciarJogo()" style="display:none;" id="btnReiniciar">Reiniciar</button>
</div>

<div id="torres">
  <div class="torre" data-torre="A">
    <div class="torre-label">A</div>
  </div>
  <div class="torre" data-torre="B">
    <div class="torre-label">B</div>
  </div>
  <div class="torre" data-torre="C">
    <div class="torre-label">C</div>
  </div>
</div>

<div id="mensagem"></div>
<div id="movimentos">Movimentos: 0</div>

<script>
  // N√∫mero de discos escolhido pelo usu√°rio (padr√£o 3)
  let numDiscos = 3;

  // Representa√ß√£o das torres como pilhas (arrays)
  let torres = { A: [], B: [], C: [] };

  // Disco que o usu√°rio selecionou para mover (null se nenhum)
  let discoSelecionado = null;

  // Contador de movimentos feitos pelo jogador
  let movimentos = 0;

  // Cria visualmente um disco com tamanho e cor de acordo
  function criarDisco(tamanho) {
    const div = document.createElement('div');
    div.classList.add('disco');
    div.dataset.tamanho = tamanho;
    div.draggable = true; // Permite arrastar com o mouse

    // Evento para iniciar arrastar o disco
    div.addEventListener('dragstart', discoDragStart);
    // Evento para selecionar o disco clicando nele
    div.addEventListener('click', () => selecionarDisco(div));
    return div;
  }

  // Inicia o jogo configurando torres e discos conforme o n√∫mero escolhido
  function iniciarJogo() {
    // Pega o n√∫mero de discos digitado
    numDiscos = parseInt(document.getElementById('numDiscos').value);

    // Verifica se o n√∫mero est√° entre 3 e 5
    if (isNaN(numDiscos) || numDiscos < 3 || numDiscos > 5) {
      alert('Digite um n√∫mero entre 3 e 5.');
      return;
    }

    // Reseta as torres, sele√ß√£o e contador de movimentos
    torres = { A: [], B: [], C: [] };
    discoSelecionado = null;
    movimentos = 0;
    atualizarMovimentos();
    document.getElementById('mensagem').textContent = '';

    // Mostra o bot√£o reiniciar
    document.getElementById('btnReiniciar').style.display = 'inline-block';

    // Limpa as torres na tela e remove eventos antigos
    document.querySelectorAll('.torre').forEach(torreDiv => {
      torreDiv.innerHTML = `<div class="torre-label">${torreDiv.dataset.torre}</div>`;
      torreDiv.replaceWith(torreDiv.cloneNode(true)); // Remove eventos antigos
    });

    // Seleciona a torre A para colocar os discos iniciais
    const torreA = document.querySelector('.torre[data-torre="A"]');

    // Coloca os discos na torre A, do maior (embaixo) para o menor (topo)
    for (let i = numDiscos; i >= 1; i--) {
      torres.A.push(i);
      const disco = criarDisco(i);
      torreA.appendChild(disco);
    }

    // Configura eventos para as torres (drag and drop e clique)
    ['A', 'B', 'C'].forEach(t => {
      const torreDiv = document.querySelector(`.torre[data-torre="${t}"]`);
      torreDiv.addEventListener('dragover', torreDragOver);
      torreDiv.addEventListener('drop', torreDrop);
      torreDiv.addEventListener('click', () => tentarMover(t));
    });
  }

  // Reinicia o jogo limpando mensagens e reiniciando as torres
  function reiniciarJogo() {
    document.getElementById('mensagem').textContent = '';
    discoSelecionado = null;
    movimentos = 0;
    atualizarMovimentos();
    iniciarJogo();
  }

  // Seleciona um disco quando o usu√°rio clica nele
  function selecionarDisco(div) {
    // Remove sele√ß√£o antiga, se tiver
    if (discoSelecionado) {
      discoSelecionado.classList.remove('selecionado');
    }
    // Marca o novo disco como selecionado
    discoSelecionado = div;
    discoSelecionado.classList.add('selecionado');
  }

  // Tenta mover o disco selecionado para a torre clicada
  function tentarMover(destino) {
    if (!discoSelecionado) return; // Se n√£o tiver disco selecionado, sai

    // Descobre de qual torre veio o disco selecionado
    let origem = null;
    for (const t of ['A','B','C']) {
      const torreDiv = document.querySelector(`.torre[data-torre="${t}"]`);
      if (torreDiv.contains(discoSelecionado)) {
        origem = t;
        break;
      }
    }

    // Se n√£o encontrou a origem ou destino √© igual √† origem, n√£o faz nada
    if (!origem || origem === destino) return;

    // Pega o tamanho do disco que est√° sendo movido
    const discoOrigem = torres[origem][torres[origem].length -1];

    // Pega o disco do topo da torre destino, ou infinito se vazio
    const discoDestino = torres[destino].length > 0 ? torres[destino][torres[destino].length -1] : Infinity;

    // Verifica se o movimento √© v√°lido (disco menor sobre maior)
    if (discoOrigem > discoDestino) {
      alert('Movimento inv√°lido: n√£o pode colocar disco maior sobre menor.');
      return;
    }

    // Remove disco da torre origem e adiciona na torre destino
    torres[origem].pop();
    torres[destino].push(discoOrigem);

    movimentos++;
    atualizarMovimentos();
    atualizarVisual();

    // Remove sele√ß√£o do disco depois do movimento
    discoSelecionado.classList.remove('selecionado');
    discoSelecionado = null;

    // Verifica se o jogo foi finalizado com sucesso
    checarVitoria();
  }

  // Atualiza a visualiza√ß√£o dos discos nas torres
  function atualizarVisual() {
    ['A','B','C'].forEach(t => {
      const torreDiv = document.querySelector(`.torre[data-torre="${t}"]`);
      // Limpa todos os discos para atualizar
      torreDiv.innerHTML = `<div class="torre-label">${t}</div>`;

      // Adiciona discos de acordo com o array da torre
      torres[t].forEach(d => {
        const disco = criarDisco(d);
        torreDiv.appendChild(disco);
      });
    });
  }

  // Confere se todos os discos est√£o na torre C, ou seja, se o jogo terminou
  function checarVitoria() {
    if (torres.C.length === numDiscos) {
      document.getElementById('mensagem').textContent =
        `üéâ Parab√©ns! Voc√™ completou a Torre de Hanoi em ${movimentos} movimentos!`;
      discoSelecionado = null;
    }
  }

  // Atualiza o contador de movimentos na tela
  function atualizarMovimentos() {
    document.getElementById('movimentos').textContent = `Movimentos: ${movimentos}`;
  }

  // Eventos para drag and drop dos discos
  function discoDragStart(e) {
    // Marca o disco que est√° sendo arrastado
    e.dataTransfer.setData('text/plain', e.target.dataset.tamanho);
    discoSelecionado = e.target;
    discoSelecionado.classList.add('selecionado');
  }

  // Permite que o elemento receba o drop (precisa prevenir o padr√£o)
  function torreDragOver(e) {
    e.preventDefault();
  }

  // Quando o disco √© "solto" na torre, tenta mover
  function torreDrop(e) {
    e.preventDefault();
    const torreDestino = e.currentTarget.dataset.torre;
    tentarMover(torreDestino);
  }
</script>

</body>
</html>
